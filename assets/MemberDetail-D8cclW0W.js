import{_ as R,d as Q,o as c,n as e,f as a,l as $,w as u,X as i,N as w,j as b,k as S,e as A,F as _,r as y,A as j,s as F,U as E,t as N,v as D,Q as U,g as V,i as C,Y as K,Z as L,p as T,R as O,$ as H,x as J}from"./index-CVaKkTou.js";import{M as z,_ as P,a as X}from"./MemberForm-DViKWmfL.js";import{Q as Y}from"./QMarkupTable-DWEgKcBk.js";import{f as B,g as Z}from"./date-operation-C7FPWyEO.js";import{Q as G,_ as W,a as h}from"./List-Doprxmap.js";import{A as tt,_ as et}from"./LoadingAbsolute-CgMb_-zQ.js";import{_ as at}from"./InputSelectArray-6dIorVAD.js";import{n as st}from"./Api-gOSdAdwF.js";import{A as q}from"./listsStore-D_O3ITd2.js";import{_ as lt}from"./CardHeader-DJ1g_Odt.js";import"./use-fullscreen-vi9z7smx.js";const nt={class:"q-pa-sm bg-orange-2 flex items-center justify-between"},ut={class:"flex items-center justify-between"},ot={class:"text-weight-bold"},rt={class:"flex items-center justify-between"},dt={__name:"DetailIdentity",props:{anggota:{type:Object,required:!0}},emits:["setEdit"],setup(s,{emit:p}){const g=p;return(m,t)=>(c(),Q(_,null,[e("div",nt,[t[1]||(t[1]=e("div",null,"Data Diri",-1)),a($,{dense:"",label:"Edit",outline:"",icon:"edit","no-caps":"",class:"q-px-md",onClick:t[0]||(t[0]=r=>g("setEdit"))})]),a(Y,{class:"q-ma-sm"},{default:u(()=>[e("tbody",null,[e("tr",null,[t[3]||(t[3]=e("td",null,"ID Anggota",-1)),e("td",ut,[e("span",null,i(s.anggota.id),1),e("div",null,[t[2]||(t[2]=e("span",{class:"text-caption"},"Angkatan: ",-1)),e("span",null,i(s.anggota.th_bergabung),1)])])]),e("tr",null,[t[4]||(t[4]=e("td",null,"Nama",-1)),e("td",null,i(s.anggota.nama),1)]),e("tr",null,[t[5]||(t[5]=e("td",null,"Kelahiran",-1)),e("td",null,i(s.anggota.tmp_lahir)+", "+i(w(B)(s.anggota.tgl_lahir,"dd MMMM yyyy"))+" ("+i(w(Z)(s.anggota.tgl_lahir))+" tahun) ",1)]),e("tr",null,[t[6]||(t[6]=e("td",null,"Alamat Lengkap",-1)),e("td",null,i(s.anggota.alamat_lengkap),1)]),e("tr",null,[t[8]||(t[8]=e("td",null,"Keanggotaan",-1)),e("td",null,[b(i(s.anggota.keanggotaan)+" (",1),e("span",ot,i(s.anggota.status_max),1),t[7]||(t[7]=b(") ",-1))])]),e("tr",null,[t[9]||(t[9]=e("td",null,"Kelompok",-1)),e("td",null,i(s.anggota.kelompok),1)]),e("tr",null,[t[10]||(t[10]=e("td",null,"Nomor HP",-1)),e("td",rt,[e("span",null,i(s.anggota.no_hp),1),s.anggota.no_hp?(c(),S($,{key:0,dense:"",icon:"phone_enabled",color:"orange-7",glossy:"",round:"",outline:"",type:"a",href:`https://wa.me/${s.anggota?.no_hp?.replace(/^0/,"62")??""}?text=Assalamualaikum%20${s.anggota?.nama}`,target:"_blank",rel:"noopener noreferrer"},null,8,["href"])):A("",!0)])]),e("tr",null,[t[11]||(t[11]=e("td",null,"Email",-1)),e("td",null,i(s.anggota.email),1)])])]),_:1})],64))}},it=R(dt,[["__scopeId","data-v-a3f8c269"]]);class mt extends tt{constructor(p){super(p),this.path="statuses"}}const M=new mt,gt={__name:"StatusForm",props:{data:{type:Object,required:!0}},emits:["successDelete","successSubmit","successUpdate","successCreate"],setup(s,{emit:p}){const g=s,m=p,t=y({...g.data}),r=y(!1);let v=null;const f=g.data?.id;j(async()=>{v=document.getElementById("btn-close-form")});const k=async()=>{const n=JSON.parse(JSON.stringify(t.value));try{r.value=!0;let o=null;f?(o=await M.update(f,n),m("successUpdate",o?.status)):(o=await M.create(n),m("successCreate",o?.status)),m("successSubmit",o?.status),v.click()}catch(o){console.log("error status ",o)}finally{r.value=!1}},d=async()=>{if(await st("Hapus data ini?",!0))try{r.value=!0,await M.remove(f),v.click(),m("successDelete",f)}catch(o){console.log("error delete status ",o)}finally{r.value=!1}};return(n,o)=>(c(),S(D,{class:"full-width",style:{"max-width":"425px"}},{default:u(()=>[a(G,{onSubmit:F(k,["prevent"])},{default:u(()=>[a(W,{title:"Input Status","is-new":!w(f)},null,8,["is-new"]),r.value?(c(),S(et,{key:0})):A("",!0),a(E,{class:"q-pa-sm"},{default:u(()=>[a(N,{dense:"",outlined:"",label:"Nama","model-value":t.value?.nama+" ("+t.value?.member_id+")",disable:"",filled:"",class:"q-my-sm"},null,8,["model-value"]),a(at,{modelValue:t.value.status,"onUpdate:modelValue":o[0]||(o[0]=l=>t.value.status=l),url:"status",label:"Status *",class:"q-my-sm",rules:[l=>!!l||"Harus diisi!"]},null,8,["modelValue","rules"]),a(N,{dense:"",class:"q-my-sm",outlined:"",label:"Keterangan",modelValue:t.value.keterangan,"onUpdate:modelValue":o[1]||(o[1]=l=>t.value.keterangan=l),autogrow:""},null,8,["modelValue"])]),_:1}),a(h,{"btn-delete":!!w(f),onOnDelete:d},null,8,["btn-delete"])]),_:1})]),_:1}))}},ft={class:"q-pa-sm bg-orange-2 flex items-center justify-between"},ct={__name:"DetailStatus",props:{statuses:{type:Array,required:!0},member:{type:Object,required:!0}},emits:["deleteStatus","createStatus","updateStatus"],setup(s,{emit:p}){const g=p,m=s,t=y(!1),r=y({}),v=()=>{r.value={member_id:m.member.id,nama:m.member.nama},t.value=!0},f=k=>{r.value=k,r.value.member_id=m.member.id,r.value.nama=m.member.nama,t.value=!0};return(k,d)=>(c(),Q(_,null,[e("div",ft,[d[4]||(d[4]=e("div",null,"Riwayat Status",-1)),a($,{label:"Tambah",icon:"add",outline:"",dense:"","no-caps":"",class:"q-px-md",onClick:v})]),a(T,{bordered:"",separator:""},{default:u(()=>[!s.statuses||!s.statuses?.length?(c(),S(U,{key:0},{default:u(()=>[a(V,null,{default:u(()=>[a(C,{class:"text-negative text-center"},{default:u(()=>[...d[5]||(d[5]=[b(" Tidak ada data untuk ditampilkan. ",-1),e("br",null,null,-1),b(" Silakan tambahkan data! ",-1)])]),_:1})]),_:1})]),_:1})):(c(!0),Q(_,{key:1},K(s.statuses,(n,o)=>(c(),S(U,{key:n.id,class:L(o==0?"bg-yellow-1":"")},{default:u(()=>[a(V,null,{default:u(()=>[a(C,{overline:""},{default:u(()=>[b(i(n.status),1)]),_:2},1024),a(C,{caption:""},{default:u(()=>[b(i(w(B)(n.created_at,"dd MMMM yyyy")),1)]),_:2},1024),a(C,null,{default:u(()=>[b(i(n.keterangan??"-"),1)]),_:2},1024)]),_:2},1024),a(V,{side:""},{default:u(()=>[a($,{icon:"edit",round:"",outline:"",glossy:"",color:"orange-10",onClick:l=>f(n)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1}),a(O,{modelValue:t.value,"onUpdate:modelValue":d[3]||(d[3]=n=>t.value=n)},{default:u(()=>[a(gt,{data:r.value,onSuccessDelete:d[0]||(d[0]=n=>g("deleteStatus",n)),onSuccessCreate:d[1]||(d[1]=n=>g("createStatus",n)),onSuccessUpdate:d[2]||(d[2]=n=>g("updateStatus",n))},null,8,["data"])]),_:1},8,["modelValue"])],64))}},Vt={__name:"MemberDetail",setup(s){const{params:p}=H(),g=p.id,m=y(!1),t=y({}),r=y(!1),v=J();async function f(){try{m.value=!0;const l=await z.getById(g);t.value=l.member}catch(l){console.log("error get member id ",l)}finally{m.value=!1}}function k(l){g!=l.id&&v.push(`/members/${l.id}`),Object.assign(t.value,l)}j(async()=>{g&&await f()});const d=l=>{t.value.statuses=q.remove(t.value.statuses,l)},n=l=>{t.value.statuses=q.update(t.value.statuses,l.id,l)},o=l=>{t.value.statuses=q.create(t.value.statuses,l,"first")};return(l,x)=>(c(),S(D,null,{default:u(()=>[a(lt,{title:"Detail Anggota",onOnReload:f}),a(E,{class:"q-pa-sm q-gutter-sm",style:{"max-width":"1024px"}},{default:u(()=>[a(D,{bordered:"",flat:""},{default:u(()=>[m.value?(c(),S(P,{key:0})):A("",!0),a(it,{anggota:t.value,onSetEdit:x[0]||(x[0]=I=>r.value=!0)},null,8,["anggota"])]),_:1}),a(D,{bordered:"",flat:""},{default:u(()=>[a(ct,{statuses:t.value?.statuses||[],member:{id:t.value.id,nama:t.value.nama},onCreateStatus:o,onUpdateStatus:n,onDeleteStatus:d},null,8,["statuses","member"])]),_:1})]),_:1}),a(O,{modelValue:r.value,"onUpdate:modelValue":x[2]||(x[2]=I=>r.value=I)},{default:u(()=>[a(X,{data:t.value,onSuccessDelete:x[1]||(x[1]=()=>l.$router.go(-1)),onSuccessSubmit:k},null,8,["data"])]),_:1},8,["modelValue"])]),_:1}))}};export{Vt as default};
