import{Q as B}from"./QMarkupTable-Cu8ARG0q.js";import{r as m,$ as I,A as D,d as _,f as a,w as t,v as N,R as j,F as x,o as r,U as O,k as p,e as v,n as u,X as k,p as L,Q as b,g,i as n,j as V,ao as q,l as C,t as T,Y as A}from"./index-Dg2giWPB.js";import{_ as E}from"./CardHeader-Ck0pnQTa.js";import{_ as F}from"./UserForm-Cidro3-q.js";import{_ as M}from"./LoadingAbsolute-CN7wdAYj.js";import{U as w}from"./User-BAHJpOL2.js";import"./List-AFUfvQgg.js";import"./listsStore-Bw9IUtwH.js";import"./InputSelectArray-mbT6dUkg.js";import"./Api-C7W-rtBK.js";const G={class:"fit row wrap justify-start items-start content-start"},le={__name:"UserId",setup(H){const l=m({}),d=m(!1),{params:$}=I(),y=m(!1),f=m(!1),i=m("");async function P(o,e){const s=!o.value;l.value.roles[e].value=s;const c={name:o.name,value:s};try{await w.updateRole(l.value.id,c)}catch(U){console.log("error update user ",U),l.value.roles[e].value=!s}}const R=async()=>{const o=l.value.must_change_password;try{await w.update(l.value.id,{must_change_password:o})}catch(e){l.value.must_change_password=o?0:1,console.log("error change password",e)}},S=async()=>{if(i.value)try{d.value=!0;const o=await w.update(l.value.id,{password:i.value});Object.assign(l.value,o.user),i.value="",f.value=!1}catch(o){console.log("error set password",o)}finally{d.value=!1}};async function Q(){try{d.value=!0;const o=await w.getById($.id);l.value=o.user}catch(o){console.log("error get user by id ",o)}finally{d.value=!1}}return D(async()=>{await Q()}),(o,e)=>(r(),_(x,null,[a(N,{class:""},{default:t(()=>[a(E,{title:"Detail Pengguna",onOnReload:Q,"show-edit":!0,onOnEdit:e[0]||(e[0]=s=>y.value=!0)}),a(O,{class:"q-pa-sm relative-position",style:{"max-width":"600px"}},{default:t(()=>[d.value?(r(),p(M,{key:0})):v("",!0),a(B,{flat:"",bordered:""},{default:t(()=>[u("tbody",null,[u("tr",null,[e[7]||(e[7]=u("td",{class:"text-italic text-caption q-pr-sm"},"Nama",-1)),u("td",null,k(l.value.name),1)]),u("tr",null,[e[8]||(e[8]=u("td",{class:"text-italic text-caption q-pr-sm"},"Username",-1)),u("td",null,k(l.value.username),1)]),u("tr",null,[e[9]||(e[9]=u("td",{class:"text-italic text-caption q-pr-sm"},"Kelompok",-1)),u("td",null,k(l.value.kelompok),1)])])]),_:1}),a(L,{bordered:"",separator:"",class:"q-mt-sm"},{default:t(()=>[a(b,{class:"q-pa-sm"},{default:t(()=>[a(g,null,{default:t(()=>[a(n,{overline:""},{default:t(()=>[...e[10]||(e[10]=[V(" Password ",-1)])]),_:1}),l.value?(r(),p(n,{key:0},{default:t(()=>[a(q,{modelValue:l.value.must_change_password,"onUpdate:modelValue":e[1]||(e[1]=s=>l.value.must_change_password=s),color:"orange",label:"Harus ganti password",onClick:R,"true-value":1,"false-value":0},null,8,["modelValue"])]),_:1})):v("",!0)]),_:1}),a(g,{side:""},{default:t(()=>[a(C,{icon:"key",label:"Atur Password","no-caps":"",outline:"",onClick:e[2]||(e[2]=s=>f.value=!f.value)})]),_:1})]),_:1}),f.value?(r(),p(b,{key:0,class:"q-pa-sm"},{default:t(()=>[a(g,null,{default:t(()=>[a(n,{overline:""},{default:t(()=>[...e[11]||(e[11]=[V(" Password ",-1)])]),_:1}),l.value?(r(),p(n,{key:0},{default:t(()=>[a(T,{dense:"",outlined:"",modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=s=>i.value=s)},{after:t(()=>[a(C,{icon:"save",outline:"",label:"Simpan","no-caps":"",onClick:S})]),_:1},8,["modelValue"])]),_:1})):v("",!0)]),_:1})]),_:1})):v("",!0),a(b,{class:"q-pa-sm"},{default:t(()=>[a(g,null,{default:t(()=>[a(n,{overline:""},{default:t(()=>[...e[12]||(e[12]=[V(" User Group (Role) ",-1)])]),_:1}),l.value?(r(),p(n,{key:0},{default:t(()=>[u("div",G,[(r(!0),_(x,null,A(l.value.roles,(s,c)=>(r(),_("div",{key:c,class:"col-6"},[a(q,{"model-value":s.value,color:"orange",label:s.label,"onUpdate:modelValue":U=>P(s,c),"true-value":!0,"false-value":!1},null,8,["model-value","label","onUpdate:modelValue"])]))),128))])]),_:1})):v("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(j,{modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=s=>y.value=s)},{default:t(()=>[a(F,{onSuccessDelete:e[4]||(e[4]=()=>o.$router.go(-1)),onSuccessSubmit:e[5]||(e[5]=s=>Object.assign(l.value,s)),data:l.value},null,8,["data"])]),_:1},8,["modelValue"])],64))}};export{le as default};
